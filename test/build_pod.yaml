apiVersion: v1
kind: Pod
metadata:
  labels:
    build-app: gp-helm-charts
spec:
  containers:
  - name: charts-ci
    image: gp-docker.gitprime-ops.com/flow-ci/helmpack:latest
    tty: true
    securityContext:
      privileged: true
  - name: shellcheck
    image: koalaman/shellcheck-alpine
    tty: true
    securityContext:
      privileged: true
  - name: dind
    image: gp-docker.gitprime-ops.com/flow-ci/dind:latest
    securityContext:
      privileged: true
    volumeMounts:
      - name: dind-storage
        mountPath: /var/lib/docker
      - name: modules
        mountPath: /lib/modules
        readOnly: true
      - mountPath: /sys/fs/cgroup
        name: cgroup
    resources:
      requests:
        cpu: "2"
        memory: "4Gi"
      limits:
        cpu: "4"
        memory: "8Gi"
  volumes:
    - name: dind-storage
      emptyDir: {}
    - name: modules
      hostPath:
        path: /lib/modules
    - name: cgroup
      hostPath:
        path: /sys/fs/cgroup
        type: Directory
